<div class="map-container">
<header class="header">
  <h1>ğŸŒ World Conquest Map</h1>
  <div class="user-info">
    <span class="stats">
      <strong>{{ username }}</strong> | 
      ğŸ™ï¸ {{ totalCities }} ciudades | 
      ğŸ‘¥ {{ totalInhabitants.toLocaleString() }} hab. |
      ğŸŒ {{ conqueredCountries }} paÃ­ses
    </span>
    <button (click)="goToRankings()" class="btn-rankings">ğŸ† Rankings</button>
    <button (click)="goToInvasions()" class="btn-invasions">âš”ï¸ Invasiones</button>
    <button (click)="logout()" class="btn-logout">Cerrar SesiÃ³n</button>
  </div>
</header>

  <div class="content">
   <aside class="sidebar">
  <!-- SecciÃ³n de Temporada (igual) -->
  <div class="sidebar-section">
    <h3>â° Temporada Activa</h3>
    @if (activeSeason) {
      <div class="season-info">
        <p style="font-weight: 600; margin-bottom: 8px;">{{ activeSeason.name }}</p>
        <p style="font-size: 0.85rem; color: #666; margin-bottom: 8px;">
          Termina: {{ activeSeason.end_date | date:'short' }}
        </p>
        @if (activeSeason.prize_amount) {
          <div style="background: #fef3c7; padding: 8px; border-radius: 6px; text-align: center; font-weight: 600;">
            ğŸ† Premio: ${{ activeSeason.prize_amount }}
          </div>
        }
      </div>
    } @else {
      <p class="no-cities">No hay temporada activa</p>
    }
  </div>

  <!-- NUEVA SECCIÃ“N: Feed de Eventos -->
  <div class="sidebar-section">
    @if (activeSeason) {
      <app-events-feed [seasonId]="activeSeason.id" [limit]="10"></app-events-feed>
    }
  </div>

  <!-- SecciÃ³n de Tus Ciudades (igual) -->
  <div class="sidebar-section">
    <h3>ğŸ™ï¸ Tus Ciudades ({{ userCities.length }})</h3>
    @if (userCities.length > 0) {
      <div class="cities-list">
        @for (city of userCities; track city.id) {
          <div class="city-item">
            <strong>{{ city.name }}</strong>
            <small>{{ city.ownership?.[0]?.virtual_inhabitants?.toLocaleString() }}</small>
          </div>
        }
      </div>
    } @else {
      <p class="no-cities">AÃºn no tienes ciudades. Â¡Compra tu primera ciudad en el mapa!</p>
    }
  </div>

  <!-- SecciÃ³n de Leyenda (igual) -->
  <div class="sidebar-section">
    <h3>ğŸ“– Leyenda del Mapa</h3>
    <div style="display: flex; flex-direction: column; gap: 8px;">
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display: block; width: 20px; height: 20px; border-radius: 50%; background: #22c55e; border: 2px solid white;"></span>
        <span style="font-size: 0.9rem;">Tus ciudades</span>
      </div>
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display: block; width: 20px; height: 20px; border-radius: 50%; background: #ef4444; border: 2px solid white;"></span>
        <span style="font-size: 0.9rem;">Ciudades ocupadas</span>
      </div>
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display: block; width: 20px; height: 20px; border-radius: 50%; background: #3388ff; border: 2px solid white;"></span>
        <span style="font-size: 0.9rem;">Disponibles para comprar</span>
      </div>
    </div>
  </div>
</aside>
    <main class="map-wrapper">
      <div id="map"></div>
    </main>
  </div>
</div>